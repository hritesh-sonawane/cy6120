rules:
  - id: CVE-2024-23731
    message: >
      "Insecure use of yaml.load() detected. This can lead to arbitrary code
      execution. Use yaml.SafeLoader instead to safely deserialize YAML
      content."
    languages:
      - python
    severity: ERROR
    pattern-either:
      - pattern: |
          yaml.load(..., Loader=yaml.Loader, ...)
      - pattern: |
          $VAR = yaml.Loader
          ...
          yaml.load(..., Loader=$VAR, ...)
      - pattern: |
          $DICT = {...}
          ...
          $VAR = $DICT[$KEY]
          ...
          yaml.load(..., Loader=$VAR, ...)