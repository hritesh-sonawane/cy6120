import yaml

# Vulnerable: using Loader dynamically assigned
Loader = yaml.Loader
with open('example.yaml', 'r') as file:
    yaml_data = yaml.load(file, Loader=Loader)  #ruleid: CVE-2024-23731

print(yaml_data)

# Using Dict to indirectly assign
loader_map = {"unsafe": yaml.Loader}
Loader = loader_map["unsafe"]
yaml.load(file, Loader=Loader)  #ruleid: CVE-2024-23731